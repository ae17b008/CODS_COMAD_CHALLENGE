
Lmod is automatically replacing "intel/2020.1.217" with "gcc/9.3.0".


Due to MODULEPATH changes, the following have been reloaded:
  1) blis/0.8.1     2) flexiblas/3.0.4     3) openmpi/4.0.3

pyarrow                            8.0.0                   
Defaulting to user installation because normal site-packages is not writeable
Ignoring pip: markers 'python_version < "3"' don't match your environment
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2020/avx2, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/avx2, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2020/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Requirement already satisfied: datasets in /home/ksjoe30/.local/lib/python3.8/site-packages (2.14.4+computecanada)
Requirement already satisfied: requests>=2.19.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2022a/lib/python3.8/site-packages (from datasets) (2.27.1+computecanada)
Requirement already satisfied: numpy>=1.17 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2022a/lib/python3.8/site-packages (from datasets) (1.22.2+computecanada)
Requirement already satisfied: dill<0.3.8,>=0.3.0 in /home/ksjoe30/.local/lib/python3.8/site-packages (from datasets) (0.3.7+computecanada)
Requirement already satisfied: aiohttp in /home/ksjoe30/.local/lib/python3.8/site-packages (from datasets) (3.8.4+computecanada)
Requirement already satisfied: multiprocess in /home/ksjoe30/.local/lib/python3.8/site-packages (from datasets) (0.70.14+computecanada)
Requirement already satisfied: pandas in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2022a/lib/python3.8/site-packages (from datasets) (1.4.0+computecanada)
Requirement already satisfied: pyarrow>=8.0.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Compiler/gcc9/arrow/8.0.0/lib/python3.8/site-packages/pyarrow-8.0.0-py3.8-linux-x86_64.egg (from datasets) (8.0.0)
Requirement already satisfied: xxhash in /home/ksjoe30/.local/lib/python3.8/site-packages (from datasets) (3.2.0+computecanada)
Requirement already satisfied: fsspec[http]>=2021.11.1 in /home/ksjoe30/.local/lib/python3.8/site-packages (from datasets) (2023.9.0+computecanada)
Requirement already satisfied: huggingface-hub<1.0.0,>=0.14.0 in /home/ksjoe30/.local/lib/python3.8/site-packages (from datasets) (0.16.4+computecanada)
Requirement already satisfied: pyyaml>=5.1 in /home/ksjoe30/.local/lib/python3.8/site-packages (from datasets) (6.0+computecanada)
Requirement already satisfied: tqdm>=4.62.1 in /home/ksjoe30/.local/lib/python3.8/site-packages (from datasets) (4.66.1+computecanada)
Requirement already satisfied: packaging in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2022a/lib/python3.8/site-packages (from datasets) (21.3+computecanada)
Requirement already satisfied: certifi>=2017.4.17 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2022a/lib/python3.8/site-packages (from requests>=2.19.0->datasets) (2021.10.8+computecanada)
Requirement already satisfied: charset-normalizer~=2.0.0; python_version >= "3" in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2022a/lib/python3.8/site-packages (from requests>=2.19.0->datasets) (2.0.11+computecanada)
Requirement already satisfied: idna<4,>=2.5; python_version >= "3" in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2022a/lib/python3.8/site-packages (from requests>=2.19.0->datasets) (3.3+computecanada)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2022a/lib/python3.8/site-packages (from requests>=2.19.0->datasets) (1.26.8+computecanada)
Requirement already satisfied: yarl<2.0,>=1.0 in /home/ksjoe30/.local/lib/python3.8/site-packages (from aiohttp->datasets) (1.8.2+computecanada)
Requirement already satisfied: frozenlist>=1.1.1 in /home/ksjoe30/.local/lib/python3.8/site-packages (from aiohttp->datasets) (1.3.3+computecanada)
Requirement already satisfied: async-timeout<5.0,>=4.0.0a3 in /home/ksjoe30/.local/lib/python3.8/site-packages (from aiohttp->datasets) (4.0.3+computecanada)
Requirement already satisfied: aiosignal>=1.1.2 in /home/ksjoe30/.local/lib/python3.8/site-packages (from aiohttp->datasets) (1.3.1+computecanada)
Requirement already satisfied: attrs>=17.3.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2022a/lib/python3.8/site-packages (from aiohttp->datasets) (21.4.0+computecanada)
Requirement already satisfied: multidict<7.0,>=4.5 in /home/ksjoe30/.local/lib/python3.8/site-packages (from aiohttp->datasets) (6.0.4+computecanada)
Requirement already satisfied: python-dateutil>=2.8.1 in /home/ksjoe30/.local/lib/python3.8/site-packages (from pandas->datasets) (2.8.2+computecanada)
Requirement already satisfied: pytz>=2020.1 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2022a/lib/python3.8/site-packages (from pandas->datasets) (2021.3+computecanada)
Requirement already satisfied: filelock in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/python/3.8.10/lib/python3.8/site-packages (from huggingface-hub<1.0.0,>=0.14.0->datasets) (3.0.12)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2022a/lib/python3.8/site-packages (from huggingface-hub<1.0.0,>=0.14.0->datasets) (4.0.1+computecanada)
Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2022a/lib/python3.8/site-packages (from packaging->datasets) (3.0.7+computecanada)
Requirement already satisfied: six>=1.5 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/python/3.8.10/lib/python3.8/site-packages (from python-dateutil>=2.8.1->pandas->datasets) (1.14.0)
datasets                           2.14.4+computecanada    
Defaulting to user installation because normal site-packages is not writeable
Ignoring pip: markers 'python_version < "3"' don't match your environment
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2020/avx2, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/avx2, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2020/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Requirement already satisfied: transformers in /home/ksjoe30/.local/lib/python3.8/site-packages (4.31.0+computecanada)
Requirement already satisfied: numpy>=1.17 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2022a/lib/python3.8/site-packages (from transformers) (1.22.2+computecanada)
Requirement already satisfied: requests in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2022a/lib/python3.8/site-packages (from transformers) (2.27.1+computecanada)
Requirement already satisfied: pyyaml>=5.1 in /home/ksjoe30/.local/lib/python3.8/site-packages (from transformers) (6.0+computecanada)
Requirement already satisfied: tqdm>=4.27 in /home/ksjoe30/.local/lib/python3.8/site-packages (from transformers) (4.66.1+computecanada)
Requirement already satisfied: filelock in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/python/3.8.10/lib/python3.8/site-packages (from transformers) (3.0.12)
Requirement already satisfied: tokenizers!=0.11.3,<0.14,>=0.11.1 in /home/ksjoe30/.local/lib/python3.8/site-packages (from transformers) (0.13.2+computecanada)
Requirement already satisfied: regex!=2019.12.17 in /home/ksjoe30/.local/lib/python3.8/site-packages (from transformers) (2022.10.31+computecanada)
Requirement already satisfied: safetensors>=0.3.1 in /home/ksjoe30/.local/lib/python3.8/site-packages (from transformers) (0.3.1+computecanada)
Requirement already satisfied: huggingface-hub<1.0,>=0.14.1 in /home/ksjoe30/.local/lib/python3.8/site-packages (from transformers) (0.16.4+computecanada)
Requirement already satisfied: packaging>=20.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2022a/lib/python3.8/site-packages (from transformers) (21.3+computecanada)
Requirement already satisfied: idna<4,>=2.5; python_version >= "3" in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2022a/lib/python3.8/site-packages (from requests->transformers) (3.3+computecanada)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2022a/lib/python3.8/site-packages (from requests->transformers) (1.26.8+computecanada)
Requirement already satisfied: charset-normalizer~=2.0.0; python_version >= "3" in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2022a/lib/python3.8/site-packages (from requests->transformers) (2.0.11+computecanada)
Requirement already satisfied: certifi>=2017.4.17 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2022a/lib/python3.8/site-packages (from requests->transformers) (2021.10.8+computecanada)
Requirement already satisfied: fsspec in /home/ksjoe30/.local/lib/python3.8/site-packages (from huggingface-hub<1.0,>=0.14.1->transformers) (2023.9.0+computecanada)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2022a/lib/python3.8/site-packages (from huggingface-hub<1.0,>=0.14.1->transformers) (4.0.1+computecanada)
Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2022a/lib/python3.8/site-packages (from packaging>=20.0->transformers) (3.0.7+computecanada)
transformers                       4.31.0+computecanada    
Defaulting to user installation because normal site-packages is not writeable
Ignoring pip: markers 'python_version < "3"' don't match your environment
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2020/avx2, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/avx2, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2020/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Requirement already satisfied: torch in /home/ksjoe30/.local/lib/python3.8/site-packages (1.13.1+computecanada)
Requirement already satisfied: typing-extensions in /cvmfs/soft.computecanada.ca/easybuild/software/2020/avx2/Core/scipy-stack/2022a/lib/python3.8/site-packages (from torch) (4.0.1+computecanada)
Starting script training_hf_spftmaxLoss.py
*************** Script Started *****************

Map:   0%|          | 0/3121 [00:00<?, ? examples/s]Map:  57%|█████▋    | 1789/3121 [00:00<00:00, 17791.10 examples/s]Map: 100%|██████████| 3121/3121 [00:00<00:00, 17318.49 examples/s]
Map:   0%|          | 0/780 [00:00<?, ? examples/s]Map: 100%|██████████| 780/780 [00:00<00:00, 17420.99 examples/s]
Map:   0%|          | 0/3121 [00:00<?, ? examples/s]Map:  32%|███▏      | 1000/3121 [00:06<00:14, 150.10 examples/s]Map:  64%|██████▍   | 2000/3121 [00:13<00:07, 152.97 examples/s]Map:  96%|█████████▌| 3000/3121 [00:19<00:00, 151.04 examples/s]Map: 100%|██████████| 3121/3121 [00:20<00:00, 150.88 examples/s]Map: 100%|██████████| 3121/3121 [00:20<00:00, 151.17 examples/s]
Map:   0%|          | 0/3121 [00:00<?, ? examples/s]Map:  32%|███▏      | 1000/3121 [00:07<00:15, 140.07 examples/s]Map:  64%|██████▍   | 2000/3121 [00:14<00:07, 140.93 examples/s]Map:  96%|█████████▌| 3000/3121 [00:21<00:00, 139.64 examples/s]Map: 100%|██████████| 3121/3121 [00:22<00:00, 139.67 examples/s]Map: 100%|██████████| 3121/3121 [00:22<00:00, 139.90 examples/s]
Map:   0%|          | 0/780 [00:00<?, ? examples/s]Map: 100%|██████████| 780/780 [00:05<00:00, 142.47 examples/s]Map: 100%|██████████| 780/780 [00:05<00:00, 142.43 examples/s]
Map:   0%|          | 0/780 [00:00<?, ? examples/s]Map: 100%|██████████| 780/780 [00:05<00:00, 139.14 examples/s]Map: 100%|██████████| 780/780 [00:05<00:00, 139.10 examples/s]
Traceback (most recent call last):
  File "training_hf_softmaxLoss.py", line 120, in <module>
    loss.backward()
  File "/home/ksjoe30/.local/lib/python3.8/site-packages/torch/_tensor.py", line 488, in backward
    torch.autograd.backward(
  File "/home/ksjoe30/.local/lib/python3.8/site-packages/torch/autograd/__init__.py", line 197, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: CUDA error: CUBLAS_STATUS_EXECUTION_FAILED when calling `cublasSgemm( handle, opa, opb, m, n, k, &alpha, a, lda, b, ldb, &beta, c, ldc)`
/home/coulombc/wheels_builder/tmp.17382/python-3.8/torch/aten/src/ATen/native/cuda/Loss.cu:242: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [0,0,0] Assertion `t >= 0 && t < n_classes` failed.
/home/coulombc/wheels_builder/tmp.17382/python-3.8/torch/aten/src/ATen/native/cuda/Loss.cu:242: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [3,0,0] Assertion `t >= 0 && t < n_classes` failed.
/home/coulombc/wheels_builder/tmp.17382/python-3.8/torch/aten/src/ATen/native/cuda/Loss.cu:242: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [14,0,0] Assertion `t >= 0 && t < n_classes` failed.
/home/coulombc/wheels_builder/tmp.17382/python-3.8/torch/aten/src/ATen/native/cuda/Loss.cu:242: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [15,0,0] Assertion `t >= 0 && t < n_classes` failed.
